{
  "name": "Creating an AI Influencer for Instagram using n8n",
  "nodes": [
    {
      "parameters": {},
      "type": "n8n-nodes-base.manualTrigger",
      "typeVersion": 1,
      "position": [
        -944,
        624
      ],
      "id": "e7333f04-a7bf-4ed4-a221-ce091bd8f238",
      "name": "When clicking ‘Test workflow’"
    },
    {
      "parameters": {
        "assignments": {
          "assignments": [
            {
              "id": "116298a2-1008-4c7c-839a-dddecb29d8d2",
              "name": "SUPABASE_PROJECT_ID",
              "value": "ADD_YOURS",
              "type": "string"
            },
            {
              "id": "8d0ca179-9bdd-4ad8-aa38-13e81f572122",
              "name": "SUPABASE_BUCKET_NAME",
              "value": "instagram-images",
              "type": "string"
            },
            {
              "id": "16a4a274-a729-44d5-a8a4-f99587535345",
              "name": "INSTAGRAM_BUSINESS_ACCOUNT_ID",
              "value": "ADD_YOURS",
              "type": "string"
            },
            {
              "id": "f4e2138a-bfb8-407b-ac18-36efe67ec2d7",
              "name": "EMAIL_ADDRESS",
              "value": "ADD_YOURS",
              "type": "string"
            },
            {
              "id": "c7a51a3e-5c97-42b1-b276-af5efa000035",
              "name": "REFERENCE_IMAGE",
              "value": "reference_image.png",
              "type": "string"
            },
            {
              "id": "26e82c19-e1ae-463b-8930-20a9b72d17f5",
              "name": "PROFILE",
              "value": "=- Name: Addi\n- Age: 28\n- Profession: Nature photographer\n- What she does\n    - Travels around the globe to photograph natural sites\n    - Shares educational facts about nature and wildlife\n    - Presenter\n- Typical posts\n    - Taking photos / being in nature\n    - Research packing for trip (with computer, camera equipment)\n    - Dressed up / speaking at an event\n    - Watching sunrise / sunset\n- Appearance\n    - Eurasian (purposefully ambiguous)\n    - Medium length brown hair, brown eyes\n    - Tanned skin\n- Dress\n    - Collared short-sleeve shirts, shorts, white or tan\n    - Plain T-shirts and long pants\n\nInspired by \n- David Attenborough\n    - British host, biologist, natural historian, writer\n    - Advocacy: conservation, ecology\n- Robert Irwin",
              "type": "string"
            },
            {
              "id": "2f40e267-a0ba-411f-b0c2-ac50b65ada56",
              "name": "CURRENT_QUARTER",
              "value": "=Q{{ $now.format('q') }}",
              "type": "string"
            },
            {
              "id": "37e37860-24a3-4d61-b953-de23ef9ce0b5",
              "name": "WEEK",
              "value": "={{ $now.startOf('week').format('MMMM dd') }} ({{ $now.startOf('week').format('EEEE') }}) - {{ $now.endOf('week').format('MMMM dd') }} ({{ $now.endOf('week').format('EEEE') }})",
              "type": "string"
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.set",
      "typeVersion": 3.4,
      "position": [
        -416,
        624
      ],
      "id": "9da0865b-2e5d-4c4a-9361-4ec749dca894",
      "name": "Configure workflow"
    },
    {
      "parameters": {
        "assignments": {
          "assignments": [
            {
              "id": "c57d6fe3-c7f3-4fd9-85f2-e9e54cd59840",
              "name": "change_requests",
              "value": "={{ $json.data['Change requests'] }}",
              "type": "string"
            },
            {
              "id": "8cc398cd-70db-4c91-934f-14fac2e38e27",
              "name": "quarterly_plan",
              "value": "={{ $('Generate quarterly plan').item.json.output.quarterly_plan }}",
              "type": "string"
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.set",
      "typeVersion": 3.4,
      "position": [
        1616,
        496
      ],
      "id": "1400808c-947b-4c82-8317-f8937e8a468e",
      "name": "Change request fields"
    },
    {
      "parameters": {
        "content": "# Create quarterly plan",
        "height": 600,
        "width": 1860
      },
      "type": "n8n-nodes-base.stickyNote",
      "typeVersion": 1,
      "position": [
        -64,
        384
      ],
      "id": "d892af1e-775c-4307-b130-308bf400df8c",
      "name": "Sticky Note"
    },
    {
      "parameters": {
        "operation": "get",
        "tableId": "plans",
        "filters": {
          "conditions": [
            {
              "keyName": "period_type",
              "keyValue": "month"
            },
            {
              "keyName": "period_type",
              "keyValue": "month"
            },
            {
              "keyName": "period_index",
              "keyValue": "={{ $now.format('yyyy/MMMM') }}"
            }
          ]
        }
      },
      "type": "n8n-nodes-base.supabase",
      "typeVersion": 1,
      "position": [
        48,
        1200
      ],
      "id": "ee9e45d6-d877-4f59-b0af-f250cad84d2f",
      "name": "Get monthly plan",
      "alwaysOutputData": true
    },
    {
      "parameters": {
        "assignments": {
          "assignments": [
            {
              "id": "c57d6fe3-c7f3-4fd9-85f2-e9e54cd59840",
              "name": "change_requests",
              "value": "={{ $json.data['Change requests'] }}",
              "type": "string"
            },
            {
              "id": "8cc398cd-70db-4c91-934f-14fac2e38e27",
              "name": "monthly_plan",
              "value": "={{ $('Generate monthly plan').item.json.output.monthly_plan }}",
              "type": "string"
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.set",
      "typeVersion": 3.4,
      "position": [
        1584,
        1200
      ],
      "id": "1f14bc2e-b8d0-41b1-b52b-f6e28738f67d",
      "name": "Change request fields1"
    },
    {
      "parameters": {
        "conditions": {
          "options": {
            "caseSensitive": true,
            "leftValue": "",
            "typeValidation": "strict",
            "version": 2
          },
          "conditions": [
            {
              "id": "a753a22c-2595-4c88-8438-63102a03d113",
              "leftValue": "={{ $json.data['Approve the monthly plan?'] }}",
              "rightValue": "yes",
              "operator": {
                "type": "string",
                "operation": "equals",
                "name": "filter.operator.equals"
              }
            }
          ],
          "combinator": "and"
        },
        "options": {}
      },
      "type": "n8n-nodes-base.if",
      "typeVersion": 2.2,
      "position": [
        1408,
        1200
      ],
      "id": "0d0385af-cc53-4aa0-a4c7-4cadaf626907",
      "name": "Need changes?1"
    },
    {
      "parameters": {
        "content": "# Create monthly plan",
        "height": 620,
        "width": 1860
      },
      "type": "n8n-nodes-base.stickyNote",
      "typeVersion": 1,
      "position": [
        -64,
        1056
      ],
      "id": "8f5fe851-aa2a-4aff-9433-d4bdd711de16",
      "name": "Sticky Note1"
    },
    {
      "parameters": {
        "conditions": {
          "options": {
            "caseSensitive": true,
            "leftValue": "",
            "typeValidation": "strict",
            "version": 2
          },
          "conditions": [
            {
              "id": "ad1608d1-c4f1-40a0-a17b-f50f922c07a2",
              "leftValue": "={{ $json.data[0] }}",
              "rightValue": "",
              "operator": {
                "type": "object",
                "operation": "notEmpty",
                "singleValue": true
              }
            }
          ],
          "combinator": "and"
        },
        "options": {}
      },
      "type": "n8n-nodes-base.if",
      "typeVersion": 2.2,
      "position": [
        432,
        1200
      ],
      "id": "ece23200-0e3c-4be4-a2fb-3faaff4a5dd2",
      "name": "Has monthly plan?"
    },
    {
      "parameters": {
        "operation": "sendAndWait",
        "sendTo": "={{ $('Configure workflow').item.json.EMAIL_ADDRESS }}",
        "subject": "=[Action required] Create monthly plan for {{ $now.toFormat('yyyy/MMMM') }}",
        "message": "=Add instructions to create the monthly plan for {{ $now.toFormat('yyyy/MMMM') }}\n\nAs a reminder, here's the plan for {{ $now.format('yyyy') }}-{{ $('Configure workflow').item.json.CURRENT_QUARTER }}:\n\n{{ $('Quaterly plan aggregate').item.json.data[0].plan_value }}",
        "responseType": "customForm",
        "formFields": {
          "values": [
            {
              "fieldLabel": "Instructions",
              "fieldType": "textarea",
              "placeholder": "Instructions for the monthly plan",
              "requiredField": true
            }
          ]
        },
        "options": {
          "messageButtonLabel": "Create monthly plan"
        }
      },
      "type": "n8n-nodes-base.gmail",
      "typeVersion": 2.1,
      "position": [
        624,
        1200
      ],
      "id": "948d0100-86e4-44a6-829f-dd3bc4fda545",
      "name": "Get instructions on the monthly plan",
      "webhookId": "03a0b1ff-a665-4657-9fa2-e43aaa7e59ad"
    },
    {
      "parameters": {
        "operation": "sendAndWait",
        "sendTo": "={{ $('Configure workflow').item.json.EMAIL_ADDRESS }}",
        "subject": "=[action required] Approve monthly plan for {{ $now.format('yyyy/MMMM') }}",
        "message": "=The following monthly plan was generated for {{ $now.format('yyyy/MMMM') }}, please approve or ask for changes\n\n{{ $json.output.monthly_plan }}",
        "responseType": "customForm",
        "formFields": {
          "values": [
            {
              "fieldLabel": "Approve the monthly plan?",
              "fieldType": "dropdown",
              "fieldOptions": {
                "values": [
                  {
                    "option": "yes"
                  },
                  {
                    "option": "no - I'll add my change requests below"
                  }
                ]
              },
              "requiredField": true
            },
            {
              "fieldLabel": "Change requests",
              "fieldType": "textarea",
              "placeholder": "(optional) Add your change requests"
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.gmail",
      "typeVersion": 2.1,
      "position": [
        1216,
        1200
      ],
      "id": "d5b04291-63dd-498d-b0e9-fae2c60da27e",
      "name": "Montly plan approval",
      "webhookId": "08e878d2-3f61-45b5-9b90-e06f96f632ad"
    },
    {
      "parameters": {
        "tableId": "plans",
        "fieldsUi": {
          "fieldValues": [
            {
              "fieldId": "period_type",
              "fieldValue": "month"
            },
            {
              "fieldId": "period_index",
              "fieldValue": "={{ $now.format('yyyy/MMMM') }}"
            },
            {
              "fieldId": "plan_value",
              "fieldValue": "={{ $('Generate monthly plan').item.json.output.monthly_plan }}"
            }
          ]
        }
      },
      "type": "n8n-nodes-base.supabase",
      "typeVersion": 1,
      "position": [
        1584,
        1424
      ],
      "id": "27cd2fa0-870d-42d5-970e-e4f7b5d7b02d",
      "name": "Save monthly plan"
    },
    {
      "parameters": {
        "content": "# Create weekly plan",
        "height": 580,
        "width": 1860
      },
      "type": "n8n-nodes-base.stickyNote",
      "typeVersion": 1,
      "position": [
        -64,
        1760
      ],
      "id": "dcb89fe4-1563-446b-95b8-a6d41269a721",
      "name": "Sticky Note2"
    },
    {
      "parameters": {
        "operation": "get",
        "tableId": "plans",
        "filters": {
          "conditions": [
            {
              "keyName": "period_type",
              "keyValue": "week"
            },
            {
              "keyName": "period_index",
              "keyValue": "={{ $now.format('yyyy/week-WW') }}"
            }
          ]
        }
      },
      "type": "n8n-nodes-base.supabase",
      "typeVersion": 1,
      "position": [
        48,
        1856
      ],
      "id": "06cbaf2e-8cf4-493e-ba5d-97f01afd11cf",
      "name": "Get weekly plan",
      "retryOnFail": false,
      "alwaysOutputData": true
    },
    {
      "parameters": {
        "conditions": {
          "options": {
            "caseSensitive": true,
            "leftValue": "",
            "typeValidation": "strict",
            "version": 2
          },
          "conditions": [
            {
              "id": "b728c77c-a939-4388-b8b7-9465b5243ee0",
              "leftValue": "={{ $json.data[0] }}",
              "rightValue": "",
              "operator": {
                "type": "object",
                "operation": "notEmpty",
                "singleValue": true
              }
            }
          ],
          "combinator": "and"
        },
        "options": {}
      },
      "type": "n8n-nodes-base.if",
      "typeVersion": 2.2,
      "position": [
        432,
        1856
      ],
      "id": "923404e2-e790-4ff7-b5e6-4969a63cf090",
      "name": "Has weekly plan?"
    },
    {
      "parameters": {
        "operation": "sendAndWait",
        "sendTo": "={{ $('Configure workflow').item.json.EMAIL_ADDRESS }}",
        "subject": "=[Action required] Create weekly plan for {{ $('Configure workflow').item.json.WEEK }}",
        "message": "=Add instructions to create the weekly plan for {{ $('Configure workflow').item.json.WEEK }}\n\nAs a reminder, here's the {{ $now.format('yyyy') }}-{{ $('Configure workflow').item.json.CURRENT_QUARTER }} plan:\n\n{{ $('Quaterly plan aggregate').item.json.data[0].plan_value }}\n\nAnd this is the monthly plan:\n\n{{ $('Monthly plan aggregate').item.json.data[0].plan_value }}",
        "responseType": "customForm",
        "formFields": {
          "values": [
            {
              "fieldLabel": "Instructions",
              "fieldType": "textarea",
              "placeholder": "Instructions for the weekly plan",
              "requiredField": true
            }
          ]
        },
        "options": {
          "messageButtonLabel": "Create weekly plan"
        }
      },
      "type": "n8n-nodes-base.gmail",
      "typeVersion": 2.1,
      "position": [
        624,
        1856
      ],
      "id": "79cea29a-2975-4dcb-860e-59890a76ded9",
      "name": "Get instructions on the weekly plan",
      "webhookId": "03a0b1ff-a665-4657-9fa2-e43aaa7e59ad"
    },
    {
      "parameters": {
        "operation": "sendAndWait",
        "sendTo": "={{ $('Configure workflow').item.json.EMAIL_ADDRESS }}",
        "subject": "=[action required] Approve weekly plan for {{ $('Configure workflow').item.json.WEEK }}",
        "message": "=The following weekly plan was generated for {{ $('Configure workflow').item.json.WEEK }}, please approve or ask for changes\n\n{{ $json.output.weekly_plan }}",
        "responseType": "customForm",
        "formFields": {
          "values": [
            {
              "fieldLabel": "Approve the weekly plan?",
              "fieldType": "dropdown",
              "fieldOptions": {
                "values": [
                  {
                    "option": "yes"
                  },
                  {
                    "option": "no - I'll add my change requests below"
                  }
                ]
              },
              "requiredField": true
            },
            {
              "fieldLabel": "Change requests",
              "fieldType": "textarea",
              "placeholder": "(optional) Add your change requests"
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.gmail",
      "typeVersion": 2.1,
      "position": [
        1152,
        1856
      ],
      "id": "11056982-bba2-406f-aa68-537db62e7c34",
      "name": "Weekly plan approval",
      "webhookId": "08e878d2-3f61-45b5-9b90-e06f96f632ad"
    },
    {
      "parameters": {
        "conditions": {
          "options": {
            "caseSensitive": true,
            "leftValue": "",
            "typeValidation": "strict",
            "version": 2
          },
          "conditions": [
            {
              "id": "a753a22c-2595-4c88-8438-63102a03d113",
              "leftValue": "={{ $json.data['Approve the weekly plan?'] }}",
              "rightValue": "yes",
              "operator": {
                "type": "string",
                "operation": "equals",
                "name": "filter.operator.equals"
              }
            }
          ],
          "combinator": "and"
        },
        "options": {}
      },
      "type": "n8n-nodes-base.if",
      "typeVersion": 2.2,
      "position": [
        1328,
        1856
      ],
      "id": "00985d88-8f3c-441b-962b-761ab9b4d35f",
      "name": "Changes to the weekly plan?"
    },
    {
      "parameters": {
        "assignments": {
          "assignments": [
            {
              "id": "c57d6fe3-c7f3-4fd9-85f2-e9e54cd59840",
              "name": "change_requests",
              "value": "={{ $json.data['Change requests'] }}",
              "type": "string"
            },
            {
              "id": "8cc398cd-70db-4c91-934f-14fac2e38e27",
              "name": "weekly_plan",
              "value": "={{ $('Generate weekly plan').item.json.output.weekly_plan }}",
              "type": "string"
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.set",
      "typeVersion": 3.4,
      "position": [
        1504,
        1856
      ],
      "id": "267efb83-231b-4d8b-966f-c82797ff0e38",
      "name": "Weekly plan change fields"
    },
    {
      "parameters": {
        "tableId": "plans",
        "fieldsUi": {
          "fieldValues": [
            {
              "fieldId": "period_type",
              "fieldValue": "week"
            },
            {
              "fieldId": "period_index",
              "fieldValue": "={{ $now.format('yyyy/week-WW') }}"
            },
            {
              "fieldId": "plan_value",
              "fieldValue": "={{ $('Generate weekly plan').item.json.output.weekly_plan }}"
            }
          ]
        }
      },
      "type": "n8n-nodes-base.supabase",
      "typeVersion": 1,
      "position": [
        1504,
        2080
      ],
      "id": "c4bf8e3a-6b17-4818-a20e-46b123b4800a",
      "name": "Save weekly plan"
    },
    {
      "parameters": {
        "aggregate": "aggregateAllItemData",
        "options": {}
      },
      "type": "n8n-nodes-base.aggregate",
      "typeVersion": 1,
      "position": [
        256,
        2624
      ],
      "id": "7258d2e1-2661-4200-be38-0b81548282a5",
      "name": "merge previous week's posts"
    },
    {
      "parameters": {
        "method": "POST",
        "url": "https://api.openai.com/v1/images/edits",
        "authentication": "predefinedCredentialType",
        "nodeCredentialType": "openAiApi",
        "sendHeaders": true,
        "headerParameters": {
          "parameters": [
            {}
          ]
        },
        "sendBody": true,
        "contentType": "multipart-form-data",
        "bodyParameters": {
          "parameters": [
            {
              "name": "prompt",
              "value": "={{ $('Generate new Instagram post').item.json.output.image_prompt }}"
            },
            {
              "parameterType": "formBinaryData",
              "name": "image",
              "inputDataFieldName": "data"
            },
            {
              "name": "model",
              "value": "gpt-image-1"
            },
            {
              "name": "quality",
              "value": "high"
            },
            {
              "name": "size",
              "value": "1024x1024"
            },
            {
              "name": "output_format",
              "value": "jpeg"
            },
            {
              "name": "output_compression",
              "value": "80"
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.2,
      "position": [
        1184,
        2624
      ],
      "id": "70590e58-4eff-4f04-96c6-b8dde9d58471",
      "name": "Generate image with OpenAI"
    },
    {
      "parameters": {
        "operation": "toBinary",
        "sourceProperty": "data[0].b64_json",
        "options": {}
      },
      "type": "n8n-nodes-base.convertToFile",
      "typeVersion": 1.1,
      "position": [
        1392,
        2624
      ],
      "id": "6f00dd9a-e2c8-431c-9daa-463577d68313",
      "name": "Convert response to image"
    },
    {
      "parameters": {
        "assignments": {
          "assignments": [
            {
              "id": "adef3034-fabf-4616-b45a-fdd262318229",
              "name": "share_link",
              "value": "=https://{{ $('Configure workflow').item.json.SUPABASE_PROJECT_ID }}.supabase.co/storage/v1/object/public/{{ $('Configure workflow').item.json.SUPABASE_BUCKET_NAME }}/{{ $('Generate unique id').item.json.image_id }}.jpg",
              "type": "string"
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.set",
      "typeVersion": 3.4,
      "position": [
        1792,
        2624
      ],
      "id": "91ac8cc0-f28b-4ee7-9b8f-b67232374747",
      "name": "Add share link"
    },
    {
      "parameters": {
        "operation": "sendAndWait",
        "sendTo": "={{ $('Configure workflow').item.json.EMAIL_ADDRESS }}",
        "subject": "=[Action required] Approve Instagram post {{ $now.toLocaleString() }}",
        "message": "=Image: <a target=\"_blank\" href=\"{{ $json.share_link }}\">Generated Instagram image</a>\n\nPost content:\n\n{{ $('Generate new Instagram post').item.json.output.post_content }}",
        "responseType": "customForm",
        "formFields": {
          "values": [
            {
              "fieldLabel": "Approve?",
              "fieldType": "dropdown",
              "fieldOptions": {
                "values": [
                  {
                    "option": "yes"
                  },
                  {
                    "option": "no - I'll add my change requests below"
                  }
                ]
              },
              "requiredField": true
            },
            {
              "fieldLabel": "Change requests",
              "fieldType": "textarea",
              "placeholder": "(optional) Change requests for the Instagram post"
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.gmail",
      "typeVersion": 2.1,
      "position": [
        1984,
        2624
      ],
      "id": "5bfb48ce-c8d9-4b4a-b1fc-e7cbc08d8c61",
      "name": "Get approval for the post",
      "webhookId": "728f8049-2461-4c13-af6d-468328d16020"
    },
    {
      "parameters": {
        "conditions": {
          "options": {
            "caseSensitive": true,
            "leftValue": "",
            "typeValidation": "strict",
            "version": 2
          },
          "conditions": [
            {
              "id": "82e9c4ea-904d-4497-adef-ffa55082837a",
              "leftValue": "={{ $json.data['Approve?'] }}",
              "rightValue": "yes",
              "operator": {
                "type": "string",
                "operation": "equals",
                "name": "filter.operator.equals"
              }
            }
          ],
          "combinator": "and"
        },
        "options": {}
      },
      "type": "n8n-nodes-base.if",
      "typeVersion": 2.2,
      "position": [
        48,
        2960
      ],
      "id": "0352c310-d338-45cc-b15e-6ee30136e53d",
      "name": "Post approved?"
    },
    {
      "parameters": {
        "assignments": {
          "assignments": [
            {
              "id": "2c107111-1aa6-4525-9667-1b979b4cb7be",
              "name": "post_content",
              "value": "={{ $('Generate new Instagram post').item.json.output.post_content }}",
              "type": "string"
            },
            {
              "id": "fd281099-1fc1-42dd-93b2-22301e9c502f",
              "name": "image_prompt",
              "value": "={{ $('Generate new Instagram post').item.json.output.image_prompt }}",
              "type": "string"
            },
            {
              "id": "b3c122e9-a3f0-4595-8d3d-1b62a4a1dfca",
              "name": "change_requests",
              "value": "={{ $('Post approved?').item.json.data['Change requests'] }}",
              "type": "string"
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.set",
      "typeVersion": 3.4,
      "position": [
        272,
        2960
      ],
      "id": "0aaaba55-fb65-4679-8ebd-fbb87892c95c",
      "name": "Add post change request fields"
    },
    {
      "parameters": {
        "httpRequestMethod": "POST",
        "graphApiVersion": "v22.0",
        "node": "17841474225498078",
        "edge": "media",
        "options": {
          "queryParameters": {
            "parameter": [
              {
                "name": "image_url",
                "value": "={{ $('Add share link').item.json.share_link }}"
              },
              {
                "name": "caption",
                "value": "={{ $('Generate new Instagram post').item.json.output.post_content }}"
              }
            ]
          }
        }
      },
      "type": "n8n-nodes-base.facebookGraphApi",
      "typeVersion": 1,
      "position": [
        48,
        3648
      ],
      "id": "e513f3e1-94d4-4eba-abd1-96acac3f81db",
      "name": "Facebook Graph API"
    },
    {
      "parameters": {
        "action": "generate",
        "dataPropertyName": "image_id"
      },
      "type": "n8n-nodes-base.crypto",
      "typeVersion": 1,
      "position": [
        784,
        2624
      ],
      "id": "d5261741-1f6e-4049-a543-6c94aef61186",
      "name": "Generate unique id"
    },
    {
      "parameters": {
        "method": "POST",
        "url": "=https://{{ $('Configure workflow').item.json.SUPABASE_PROJECT_ID }}.supabase.co/storage/v1/object/{{ $('Configure workflow').item.json.SUPABASE_BUCKET_NAME }}/{{ $('Generate unique id').item.json.image_id }}.jpg",
        "authentication": "predefinedCredentialType",
        "nodeCredentialType": "supabaseApi",
        "sendBody": true,
        "contentType": "multipart-form-data",
        "bodyParameters": {
          "parameters": [
            {
              "parameterType": "formBinaryData",
              "name": "file",
              "inputDataFieldName": "data"
            }
          ]
        },
        "options": {
          "response": {
            "response": {
              "fullResponse": true
            }
          }
        }
      },
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.2,
      "position": [
        1584,
        2624
      ],
      "id": "334e6fa5-a930-44fb-bf75-5af88f6ea205",
      "name": "Upload image to Supabase"
    },
    {
      "parameters": {
        "httpRequestMethod": "POST",
        "graphApiVersion": "v22.0",
        "node": "17841474225498078",
        "edge": "media_publish",
        "options": {
          "queryParameters": {
            "parameter": [
              {
                "name": "creation_id",
                "value": "={{ $json.id }}"
              }
            ]
          }
        }
      },
      "type": "n8n-nodes-base.facebookGraphApi",
      "typeVersion": 1,
      "position": [
        256,
        3648
      ],
      "id": "31218c3d-84ce-4866-b987-3bf2b8a4e23b",
      "name": "Facebook Graph API1"
    },
    {
      "parameters": {
        "operation": "sendAndWait",
        "sendTo": "={{ $('Configure workflow').item.json.EMAIL_ADDRESS }}",
        "subject": "=[Action required] Create quarterly plan for {{ $now.format('yyyy') }} {{ $('Configure workflow').item.json.CURRENT_QUARTER }}",
        "message": "=Add instructions to create the quarterly plan for {{ $now.format('yyyy') }} {{ $('Configure workflow').item.json.CURRENT_QUARTER }}",
        "responseType": "customForm",
        "formFields": {
          "values": [
            {
              "fieldLabel": "Instructions",
              "fieldType": "textarea",
              "placeholder": "=Instructions for {{ $now.format('yyyy') }} {{ $('Configure workflow').item.json.CURRENT_QUARTER }} plan",
              "requiredField": true
            }
          ]
        },
        "options": {
          "messageButtonLabel": "=Create {{ $now.format('yyyy') }} {{ $('Configure workflow').item.json.CURRENT_QUARTER }} plan"
        }
      },
      "type": "n8n-nodes-base.gmail",
      "typeVersion": 2.1,
      "position": [
        624,
        496
      ],
      "id": "35b932e1-4b88-47ee-bfec-b302e318c9e6",
      "name": "Get instructions on the quarterly plan",
      "webhookId": "03a0b1ff-a665-4657-9fa2-e43aaa7e59ad"
    },
    {
      "parameters": {
        "conditions": {
          "options": {
            "caseSensitive": true,
            "leftValue": "",
            "typeValidation": "strict",
            "version": 2
          },
          "conditions": [
            {
              "id": "e2eb3395-ad04-4360-a855-7922a2534582",
              "leftValue": "={{ $json.data[0] }}",
              "rightValue": "",
              "operator": {
                "type": "object",
                "operation": "notEmpty",
                "singleValue": true
              }
            }
          ],
          "combinator": "and"
        },
        "options": {}
      },
      "type": "n8n-nodes-base.if",
      "typeVersion": 2.2,
      "position": [
        416,
        496
      ],
      "id": "d80bfb4b-5263-4cca-beca-80c10cfdfe63",
      "name": "Has quarterly plan?"
    },
    {
      "parameters": {
        "operation": "get",
        "tableId": "plans",
        "filters": {
          "conditions": [
            {
              "keyName": "period_type",
              "keyValue": "quarter"
            },
            {
              "keyName": "period_index",
              "keyValue": "={{ $now.toFormat('yyyy') }}-{{ $('Configure workflow').item.json.CURRENT_QUARTER }}"
            }
          ]
        }
      },
      "type": "n8n-nodes-base.supabase",
      "typeVersion": 1,
      "position": [
        32,
        496
      ],
      "id": "e3b2a3a7-f066-479e-b12f-99484ce78db6",
      "name": "Get quarterly plan",
      "alwaysOutputData": true
    },
    {
      "parameters": {
        "operation": "sendAndWait",
        "sendTo": "={{ $('Configure workflow').item.json.EMAIL_ADDRESS }}",
        "subject": "=[action required] Approve plan for {{ $now.format('yyyy') }}-{{ $('Configure workflow').item.json.CURRENT_QUARTER }}",
        "message": "=The following yearly plan was generated, please approve or ask for changes\n\n{{ $json.output.quarterly_plan }}",
        "responseType": "customForm",
        "formFields": {
          "values": [
            {
              "fieldLabel": "=Do you approve the plan?",
              "fieldType": "dropdown",
              "fieldOptions": {
                "values": [
                  {
                    "option": "yes"
                  },
                  {
                    "option": "no - I'll add my change requests below"
                  }
                ]
              },
              "requiredField": true
            },
            {
              "fieldLabel": "Change requests",
              "fieldType": "textarea",
              "placeholder": "(optional) Add your change requests"
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.gmail",
      "typeVersion": 2.1,
      "position": [
        1216,
        496
      ],
      "id": "8ed76361-4d2f-4e36-ad26-89bd5e4c1957",
      "name": "Get approval on the quarterly plan",
      "webhookId": "08e878d2-3f61-45b5-9b90-e06f96f632ad"
    },
    {
      "parameters": {
        "tableId": "plans",
        "fieldsUi": {
          "fieldValues": [
            {
              "fieldId": "period_type",
              "fieldValue": "quarter"
            },
            {
              "fieldId": "period_index",
              "fieldValue": "={{ $now.toFormat('yyyy') }}-{{ $('Configure workflow').item.json.CURRENT_QUARTER }}"
            },
            {
              "fieldId": "plan_value",
              "fieldValue": "={{ $('Generate quarterly plan').item.json.output.quarterly_plan }}"
            }
          ]
        }
      },
      "type": "n8n-nodes-base.supabase",
      "typeVersion": 1,
      "position": [
        1616,
        720
      ],
      "id": "fc3eee90-90ef-49f9-86a6-041508b04336",
      "name": "Save quarterly plan"
    },
    {
      "parameters": {
        "url": "=https://{{ $('Configure workflow').item.json.SUPABASE_PROJECT_ID }}.supabase.co/storage/v1/object/public/{{ $('Configure workflow').item.json.SUPABASE_BUCKET_NAME }}/{{ $('Configure workflow').item.json.REFERENCE_IMAGE }}",
        "options": {}
      },
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.2,
      "position": [
        992,
        2624
      ],
      "id": "4bc5d204-ddc8-46ca-b3b5-ca3ca0d474fe",
      "name": "Download the reference image"
    },
    {
      "parameters": {
        "operation": "getAll",
        "tableId": "posts",
        "returnAll": true,
        "filters": {
          "conditions": [
            {
              "keyName": "created_at",
              "condition": "gte",
              "keyValue": "={{ $now.minus(1, 'week') }}"
            }
          ]
        }
      },
      "type": "n8n-nodes-base.supabase",
      "typeVersion": 1,
      "position": [
        48,
        2624
      ],
      "id": "849b6a61-b9a3-4762-8a0d-be59f1984f8c",
      "name": "Get posts from the past 7 days",
      "alwaysOutputData": true
    },
    {
      "parameters": {
        "content": "# Post to instagram\n# [Guide to setup Facebook (Instagram)](https://github.com/gyoridavid/ai_agents_az/blob/main/episode_8/guide-instagram.md)",
        "height": 500,
        "width": 640,
        "color": 4
      },
      "type": "n8n-nodes-base.stickyNote",
      "typeVersion": 1,
      "position": [
        -32,
        3456
      ],
      "id": "af779615-8a07-4d47-a54e-325cd2c6d6ab",
      "name": "Sticky Note3"
    },
    {
      "parameters": {
        "content": "# Create a new instagram post",
        "height": 960,
        "width": 2240,
        "color": 5
      },
      "type": "n8n-nodes-base.stickyNote",
      "typeVersion": 1,
      "position": [
        -64,
        2448
      ],
      "id": "e98b8240-6e62-47ff-8bf6-ed6b08c5e3a1",
      "name": "Sticky Note4"
    },
    {
      "parameters": {
        "content": "# Configure!",
        "height": 600,
        "width": 400,
        "color": 3
      },
      "type": "n8n-nodes-base.stickyNote",
      "typeVersion": 1,
      "position": [
        -544,
        384
      ],
      "id": "9ccaa662-5364-441a-b620-e58ca4584374",
      "name": "Sticky Note5"
    },
    {
      "parameters": {
        "tableId": "posts",
        "fieldsUi": {
          "fieldValues": [
            {
              "fieldId": "post_summary",
              "fieldValue": "={{ $('Generate new Instagram post').item.json.output.summary }}"
            },
            {
              "fieldId": "image_path",
              "fieldValue": "={{ $('Configure workflow').item.json.SUPABASE_BUCKET_NAME }}/{{ $('Generate unique id').item.json.image_id }}.jpg"
            }
          ]
        }
      },
      "type": "n8n-nodes-base.supabase",
      "typeVersion": 1,
      "position": [
        48,
        3200
      ],
      "id": "b7cc8fa7-392b-46b4-92a5-1d3be5f44ca8",
      "name": "Save the post"
    },
    {
      "parameters": {
        "conditions": {
          "options": {
            "caseSensitive": true,
            "leftValue": "",
            "typeValidation": "strict",
            "version": 2
          },
          "conditions": [
            {
              "id": "a753a22c-2595-4c88-8438-63102a03d113",
              "leftValue": "={{ $json.data['Do you approve the plan?'] }}",
              "rightValue": "yes",
              "operator": {
                "type": "string",
                "operation": "equals",
                "name": "filter.operator.equals"
              }
            }
          ],
          "combinator": "and"
        },
        "options": {}
      },
      "type": "n8n-nodes-base.if",
      "typeVersion": 2.2,
      "position": [
        1392,
        496
      ],
      "id": "19880c32-c213-4bff-a947-0016e746ded0",
      "name": "Approve quarterly plan?"
    },
    {
      "parameters": {
        "text": "=Create a social media post for this artificial person, who's sharing her life on Instagram using the instructions below.\nUse the detailed weekly plan to find what to post today. Make sure to look at the previous posts (if available) to make sure the post fits to the plan in a logical order.\n\nFor each post, generate an instagram post (text content and an image generation prompt). \nAs I'm using a reference image for the image generation, don't describe the general look of the person, and start with \"create a photorealistic image of me\", and continue with describing the scene in great detail, make it a few paragraph long. Make sure the image prompt includes \"do not add any text on the image\".\nCreate a short summary of the post for cateloging purposes.\n\n<PersonalProfile>\n{{ $('Configure workflow').item.json.PROFILE }}\n</PersonalProfile>\n\n<WeeklyPlan>\n{{ $('Weekly plan aggregate').item.json.data[0].plan_value }}\n</WeeklyPlan>\n\n<DayOfTheWeek>\n{{ $now.format('EEEE') }}\n</DayOfTheWeek>\n\n{{ !$json.data[0].isEmpty() ? `\n<PreviousPosts>\n${$json.data.map(item => `\n<Post>\n  <PostedAt>${item.created_at}</PostedAt>\n  <Content>${item.post_summary}</Content>\n</Post>\n`).join('\\n')}\n</PreviousPosts>\n` : '' }}\n\n{{ $json.change_requests ? `\nThe post was already generated, please apply the change requests\n\n<PostContent>\n${$json.post_content}\n</PostContent>\n\n<ImagePrompt>\n${$json.image_prompt}\n</ImagePrompt>\n\n<ChangeRequests>\n${$json.change_requests}\n</ChangeRequests>\n` : '' }}",
        "attributes": {
          "attributes": [
            {
              "name": "post_content",
              "description": "the instagram post's text content to share with the image. use emojis, hashtags",
              "required": true
            },
            {
              "name": "image_prompt",
              "description": "the image prompt to use to generate the social media image",
              "required": true
            },
            {
              "name": "summary",
              "description": "short summary of the post",
              "required": true
            }
          ]
        },
        "options": {
          "systemPromptTemplate": "You are a social media expert. Create a post for instagram based on the instructions."
        }
      },
      "type": "@n8n/n8n-nodes-langchain.informationExtractor",
      "typeVersion": 1,
      "position": [
        448,
        2624
      ],
      "id": "117f244e-5f06-4300-92e9-e60a9be92656",
      "name": "Generate new Instagram post"
    },
    {
      "parameters": {
        "text": "=Create a quarterly plan for {{ $now.format('yyyy') }}-{{ $('Configure workflow').item.json.CURRENT_QUARTER }} for this artificial person, who's sharing the life events on Instagram using the instructions below. Make sure it's detailed, and every month is planned out in great depth.\n\n<PersonalProfile>\n{{ $('Configure workflow').item.json.PROFILE }}\n</PersonalProfile>\n\n<Instructions>\n{{ $json.data.Instructions }}\n</Instructions>\n\n{{ $json.change_requests ? `\nThe plan was already generated, please make the requested changes.\n\n<QuarterlyPlan>\n${$json.quarterly_plan}\n</QuarterlyPlan>\n\n<ChangeRequests>\n${$json.change_requests}\n</ChangeRequests>\n` : '' }}",
        "attributes": {
          "attributes": [
            {
              "name": "quarterly_plan",
              "description": "quarterly plan in a markdows format",
              "required": true
            }
          ]
        },
        "options": {
          "systemPromptTemplate": "You are a travel planner for a famous instagram celebrity. Create a detailed plan according to the instructions."
        }
      },
      "type": "@n8n/n8n-nodes-langchain.informationExtractor",
      "typeVersion": 1,
      "position": [
        848,
        496
      ],
      "id": "7ecaa84c-8245-4919-ba19-17de5dc7a613",
      "name": "Generate quarterly plan"
    },
    {
      "parameters": {
        "aggregate": "aggregateAllItemData",
        "options": {}
      },
      "type": "n8n-nodes-base.aggregate",
      "typeVersion": 1,
      "position": [
        224,
        496
      ],
      "id": "bedfb556-d50f-4f92-ba7a-f57ff6b920a1",
      "name": "Quaterly plan aggregate"
    },
    {
      "parameters": {
        "aggregate": "aggregateAllItemData",
        "options": {}
      },
      "type": "n8n-nodes-base.aggregate",
      "typeVersion": 1,
      "position": [
        256,
        1200
      ],
      "id": "12e05244-6699-4535-8997-75147d8b6efc",
      "name": "Monthly plan aggregate"
    },
    {
      "parameters": {
        "aggregate": "aggregateAllItemData",
        "options": {}
      },
      "type": "n8n-nodes-base.aggregate",
      "typeVersion": 1,
      "position": [
        256,
        1856
      ],
      "id": "a0ae54e6-d305-45d7-8510-e4fcb8ec997d",
      "name": "Weekly plan aggregate"
    },
    {
      "parameters": {
        "text": "=Create a monthly plan for this artificial person, who's sharing her life on Instagram using the instructions below.\nUse the {{ $now.format('yyyy') }}-{{ $('Configure workflow').item.json.CURRENT_QUARTER }} plan and the current month to create the right plan.\nEach week of the month should be planned out.\n\n<PersonalProfile>\n{{ $('Configure workflow').item.json.PROFILE }}\n</PersonalProfile>\n\n<Instructions>\n{{ $json.data.Instructions }}\n</Instructions>{{ $json.data.Instructions }}\n\n<QuarterlyPlan>\n{{ $now.format('yyyy') }}-{{ $('Configure workflow').item.json.CURRENT_QUARTER }}:\n\n{{ $('Quaterly plan aggregate').item.json.data[0].plan_value }}\n</QuarterlyPlan>\n\n<CurrentMonth>\n{{ $now.format('MMMM') }}\n</CurrentMonth>\n\n{{ $json.change_requests ? `\nThe monthly plan was already generated, please make the requested changes.\n\n<MonthlyPlan>\n${$json.monthly_plan}\n</MonthlyPlan>\n\n<ChangeRequests>\n${$json.change_requests}\n</ChangeRequests>\n` : '' }}",
        "attributes": {
          "attributes": [
            {
              "name": "monthly_plan",
              "description": "the generated monthly plan",
              "required": true
            }
          ]
        },
        "options": {
          "systemPromptTemplate": "You are a travel planner for a famous instagram celebrity. Create a detailed plan according to the instructions."
        }
      },
      "type": "@n8n/n8n-nodes-langchain.informationExtractor",
      "typeVersion": 1,
      "position": [
        848,
        1200
      ],
      "id": "dfea8089-0c8c-4087-8449-88d81ef40a48",
      "name": "Generate monthly plan"
    },
    {
      "parameters": {
        "text": "=Create a social media post calendar for this artificial person, who's sharing the life events on Instagram using the instructions below.\nUse the {{ $now.format('yyyy') }}-{{ $('Configure workflow').item.json.CURRENT_QUARTER }} plan, then monthly plan and the target week to create the right plan.\nEach day of the week should be carefully planned, monday to sunday. Add at least one paragraph to each day.\n\n<PersonalProfile>\n{{ $('Configure workflow').item.json.PROFILE }}\n</PersonalProfile>\n\n<Instructions>\n{{ $json.data.Instructions }}\n</Instructions>{{ $json.data.Instructions }}\n\n<QuarterlyPlan>\n{{ $now.format('yyyy') }}-{{ $('Configure workflow').item.json.CURRENT_QUARTER }}:\n\n{{ $('Quaterly plan aggregate').item.json.data[0].plan_value }}\n</QuarterlyPlan>\n\n<MonthlyPlan>\n{{ $('Monthly plan aggregate').item.json.data[0].plan_value }}\n</MonthlyPlan>\n\n<TargetWeek>\n{{ $('Configure workflow').item.json.WEEK }}\n</TargetWeek>\n\n{{ $json.change_requests ? `\nThe weekly plan was already generated, please make the requested changes.\n\n<WeeklyPlan>\n${$json.weekly_plan}\n</WeeklyPlan>\n\n<ChangeRequests>\n${$json.change_requests}\n</ChangeRequests>\n` : '' }}",
        "attributes": {
          "attributes": [
            {
              "name": "weekly_plan",
              "description": "the weekly plan",
              "required": true
            }
          ]
        },
        "options": {
          "systemPromptTemplate": "You are a travel planner for a famous instagram celebrity. Create a detailed plan according to the instructions."
        }
      },
      "type": "@n8n/n8n-nodes-langchain.informationExtractor",
      "typeVersion": 1,
      "position": [
        832,
        1856
      ],
      "id": "03a236fb-c2bb-4b88-9009-fae49abdbc5a",
      "name": "Generate weekly plan"
    },
    {
      "parameters": {
        "model": {
          "__rl": true,
          "value": "gpt-4.1",
          "mode": "list",
          "cachedResultName": "gpt-4.1"
        },
        "options": {}
      },
      "type": "@n8n/n8n-nodes-langchain.lmChatOpenAi",
      "typeVersion": 1.2,
      "position": [
        -416,
        1376
      ],
      "id": "24015fd7-bb6e-4ca7-aa6c-dcd64432ef94",
      "name": "OpenAI Chat Model"
    },
    {
      "parameters": {
        "content": "# Read the guides on GitHub\n\n## [Guide to setup Supabase](https://github.com/gyoridavid/ai_agents_az/blob/main/episode_8/guide-supabase.md)\n## [Guide to setup Facebook (Instagram)](https://github.com/gyoridavid/ai_agents_az/blob/main/episode_8/guide-instagram.md)",
        "height": 220,
        "width": 500
      },
      "type": "n8n-nodes-base.stickyNote",
      "typeVersion": 1,
      "position": [
        96,
        80
      ],
      "id": "5999a450-500e-4416-898f-b9257c3bc3b2",
      "name": "Sticky Note9"
    },
    {
      "parameters": {
        "content": "# Use any LLM provider\n\n- ollama\n- openrouter\n- openai\n- gemini\n- ...",
        "height": 620,
        "width": 420,
        "color": 3
      },
      "type": "n8n-nodes-base.stickyNote",
      "typeVersion": 1,
      "position": [
        -544,
        1056
      ],
      "id": "05f93006-0391-4333-94e1-312a5013478a",
      "name": "Sticky Note10"
    }
  ],
  "pinData": {},
  "connections": {
    "When clicking ‘Test workflow’": {
      "main": [
        [
          {
            "node": "Configure workflow",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Configure workflow": {
      "main": [
        [
          {
            "node": "Get quarterly plan",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Change request fields": {
      "main": [
        [
          {
            "node": "Generate quarterly plan",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Change request fields1": {
      "main": [
        [
          {
            "node": "Generate monthly plan",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Need changes?1": {
      "main": [
        [
          {
            "node": "Save monthly plan",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "Change request fields1",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Get monthly plan": {
      "main": [
        [
          {
            "node": "Monthly plan aggregate",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Has monthly plan?": {
      "main": [
        [
          {
            "node": "Get weekly plan",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "Get instructions on the monthly plan",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Get instructions on the monthly plan": {
      "main": [
        [
          {
            "node": "Generate monthly plan",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Montly plan approval": {
      "main": [
        [
          {
            "node": "Need changes?1",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Save monthly plan": {
      "main": [
        [
          {
            "node": "Get monthly plan",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Get weekly plan": {
      "main": [
        [
          {
            "node": "Weekly plan aggregate",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Has weekly plan?": {
      "main": [
        [
          {
            "node": "Get posts from the past 7 days",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "Get instructions on the weekly plan",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Get instructions on the weekly plan": {
      "main": [
        [
          {
            "node": "Generate weekly plan",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Weekly plan approval": {
      "main": [
        [
          {
            "node": "Changes to the weekly plan?",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Changes to the weekly plan?": {
      "main": [
        [
          {
            "node": "Save weekly plan",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "Weekly plan change fields",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Weekly plan change fields": {
      "main": [
        [
          {
            "node": "Generate weekly plan",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Save weekly plan": {
      "main": [
        [
          {
            "node": "Get weekly plan",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "merge previous week's posts": {
      "main": [
        [
          {
            "node": "Generate new Instagram post",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Generate image with OpenAI": {
      "main": [
        [
          {
            "node": "Convert response to image",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Convert response to image": {
      "main": [
        [
          {
            "node": "Upload image to Supabase",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Add share link": {
      "main": [
        [
          {
            "node": "Get approval for the post",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Get approval for the post": {
      "main": [
        [
          {
            "node": "Post approved?",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Post approved?": {
      "main": [
        [
          {
            "node": "Save the post",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "Add post change request fields",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Add post change request fields": {
      "main": [
        [
          {
            "node": "Generate new Instagram post",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Generate unique id": {
      "main": [
        [
          {
            "node": "Download the reference image",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Upload image to Supabase": {
      "main": [
        [
          {
            "node": "Add share link",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Facebook Graph API": {
      "main": [
        [
          {
            "node": "Facebook Graph API1",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Get instructions on the quarterly plan": {
      "main": [
        [
          {
            "node": "Generate quarterly plan",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Has quarterly plan?": {
      "main": [
        [
          {
            "node": "Get monthly plan",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "Get instructions on the quarterly plan",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Get quarterly plan": {
      "main": [
        [
          {
            "node": "Quaterly plan aggregate",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Get approval on the quarterly plan": {
      "main": [
        [
          {
            "node": "Approve quarterly plan?",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Save quarterly plan": {
      "main": [
        [
          {
            "node": "Get quarterly plan",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Download the reference image": {
      "main": [
        [
          {
            "node": "Generate image with OpenAI",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Get posts from the past 7 days": {
      "main": [
        [
          {
            "node": "merge previous week's posts",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Save the post": {
      "main": [
        [
          {
            "node": "Facebook Graph API",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Approve quarterly plan?": {
      "main": [
        [
          {
            "node": "Save quarterly plan",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "Change request fields",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Generate new Instagram post": {
      "main": [
        [
          {
            "node": "Generate unique id",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Generate quarterly plan": {
      "main": [
        [
          {
            "node": "Get approval on the quarterly plan",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Quaterly plan aggregate": {
      "main": [
        [
          {
            "node": "Has quarterly plan?",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Monthly plan aggregate": {
      "main": [
        [
          {
            "node": "Has monthly plan?",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Weekly plan aggregate": {
      "main": [
        [
          {
            "node": "Has weekly plan?",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Generate monthly plan": {
      "main": [
        [
          {
            "node": "Montly plan approval",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Generate weekly plan": {
      "main": [
        [
          {
            "node": "Weekly plan approval",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "OpenAI Chat Model": {
      "ai_languageModel": [
        [
          {
            "node": "Generate quarterly plan",
            "type": "ai_languageModel",
            "index": 0
          },
          {
            "node": "Generate monthly plan",
            "type": "ai_languageModel",
            "index": 0
          },
          {
            "node": "Generate weekly plan",
            "type": "ai_languageModel",
            "index": 0
          },
          {
            "node": "Generate new Instagram post",
            "type": "ai_languageModel",
            "index": 0
          }
        ]
      ]
    }
  },
  "active": false,
  "settings": {
    "executionOrder": "v1"
  },
  "versionId": "5eeda3bd-ef1f-474f-8b6b-1b7c02a2642b",
  "meta": {
    "templateCredsSetupCompleted": true,
    "instanceId": "486f6ab233e310095534742d326fe4f5df97a9f51652428851fe88dc9653e1f6"
  },
  "id": "732Q6vKEGCLLrnKw",
  "tags": []
}